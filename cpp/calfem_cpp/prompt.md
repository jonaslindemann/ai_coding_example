Convert this CALFEM Python function to a C++ function using the Eigen C++ library.